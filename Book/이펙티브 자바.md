# 4. 클래스와 인터페이스
### 아이템 15 클래스와 멤버의 접근 권한을 최소화하라
- 잘 설계된 컴포넌트
  - 클래스 내부 데이터와 내부 구현 정보를 외부 컴포넌트로부터 잘 숨긴 컴포넌트
  - 모든 내부 구현을 완벽히 숨겨, 구현과 API를 깔끔히 분리
  - 오직 API를 통해서만 다른 컴포넌트와 소통하며 서로의 내부 동작 방식에는 전혀 개의치 않음.
  - = 정보 은닉, 캡슐화
- 정보 은닉의 장점
  - 시스템 개발 속도를 높임. 여러 컴포넌트를 병렬로 개발 가능하기 때문
  - 시스템 관리 비용을 낮춤. 각 컴포넌트를 빠르게 파악하고 디버깅 가능하며, 다른 컴포넌트로 교체하는 부담도 적음
  - 성능 최적화에 도움을 줌. 다른 컴포넌트에 영향을 주지 않고 해당 컴포넌트만 최적화할 수 있기 때문
  - 소프트웨어 재사용성을 높임.
  - 큰 시스템을 제작하는 난이도를 낮춤. 시스템 전체가 아직 완성되지 않은 상태에서도 개별 컴포넌트의 동작을 검증할 수 있기 때문.
- 자바에서 정보 은닉의 핵심 : 접근 제한자
- 기본 원칙 : 모든 클래스와 멤버의 접근성을 가능한 한 좁혀야 함.
- 패키지 외부에서 쓸 이유가 없다면 package-private으로 선언하기. (public -> package-private)
- 클래스의 공개 API를 세심히 설계 후, 그 외의 모든 멤버는 private하게 만들기.
- 그 다음 오직 같은 패키지의 다른 클래스가 접근해야 하는 멤버에 한하여 package-private으로 풀어주기.
- protected부터 그 멤버에 접근할 수 있는 대상 범위가 엄청나게 넓어지므로, protected 멤버의 수는 적을수록 좋다.
- 테스트만을 위해 클래스, 인터페이스, 멤버를 공개 API로 만들어서는 안 된다.
- public 클래스의 인스턴스 필드는 되도록 public이 아니어야 한다.
- public 가변 필드는 갖는 클래스는 일반적으로 스레드 안전하지 않다.
  - 예외 : 해당 클래스가 표현하는 추상 개념을 완성하는 데 꼭 필요한 구성요소로써의 상수라면 public static final 필드로 공개해도 좋음.
- 클래스에서 public static final 배열 필드를 두거나 이 필드를 반환하는 접근자 메서드를 제공해서는 안 된다.

#
### 아이템 16 public 클래스에서는 public 필드가 아닌 접근자 메서드를 사용하라
- public 클래스는 절대 가변 필드를 직접 노출(public)해서는 안 된다.
- 불편 필드라면 노출해도 덜 위험하지만 완전히 안심할 수는 없다.
- 패키지 바깥에서 접근할 수 있는 클래스(public)라면 접근자(getter)를 제공해서 클래스 내부 표현 방식을 언제든 바꿀 수 있는 유연성을 취하자.
- package-private 클래스 혹은 private 중첩 클래스라면 데이터 필드를 노출한다 해도 하등의 문제가 없다.

#
### 아이템 17 변경 가능성을 최소화하라
- 불변 클래스 
  - 그 인스턴스의 내부 값을 수정할 수 없는 클래스
  - 가변 클래스보다 설계하고 구현하고 사용하기 쉬우며, 오류가 생길 여지도 적고 훨씬 안전
- 불변 클래스를 만드는 5가지 규칙
  - 객체의 상태를 변경하는 메서드(변경자, setter)를 제공하지 않는다.
  - 클래스를 확장할 수 없도록 한다.
  - 모든 필드를 final로 선언한다. (설계자의 의도를 명확히 드러내기)
  - 모든 필드를 private으로 선언한다. (직접 수정을 막는다.)
  - 자신 외에는 내부의 가변 컴포넌트에 접근할 수 없도록 한다.
- 함수형 프로그래밍
  - 피연산자에 함수를 적용해 그 결과를 반환하지만, 피연산자 자체는 그대로인 프로그래밍 패턴
  - 그 반대는 절차적/명령형 프로그래밍 (= 메서드에서 피연산자인 자신을 수정해 자신의 상태가 변하게 함)
  - 함수형 프로그래밍을 하면 코드에서 불변이 되는 영역의 비율이 높아지는 장점을 누릴 수 있다.
- "불변 객체는 단순하다." 
  - 따라서 불변 객체는 근본적으로 스레드 안전하며 따로 동기화할 필요가 없다. 여러 스레드가 동시에 사용해도 절대 훼손되지 않는다. 불변 객체는 안심하고 공유할 수 있다.
  - 불변 클래스라면 한번 만든 인스턴스를 최대한 재활용하기 (ex. public static final)
  - 불변 객체는 자유롭게 공유할 수 있음은 물론, 불변 객체 끼리는 내부 데이터를 공유할 수 있다.
  - 객체를 만들 때 다른 불변 객체들을 구성요소로 사용하면 이점이 많다.
  - 불변 객체는 그 자체로 실패 원자성(메서드에서 예외가 발생한 후에도 그 객체는 여전히 메서드 호출 전과 같은 유효한 상태인 성질)을 제공한다.
  - 단점이라면 값이 다르면 반드시 독립된 객체로 만들어야 한다는 것이다.
- 불변 클래스를 만드는 또 다른 설계 방법
  - 가장 쉬운 방법 : final 클래스 선언
  - 더 유연한 방법 : 모든 생성자를 private 혹은 package-private으로 만들고 public 정적 팩터리를 제공하는 방법
- 모든 필드가 final이고 어떤 메서드도 그 객체를 수정할 수 없어야 한다는 규칙은 과한 감이 있음.
  - 살짝 완화하자면, 어떤 메서드도 객체의 상태 중 외부에 비치는 값을 변경할 수 없어야 한다.
  - 계산 비용이 큰 값을 처음 쓰일 때 계산하여 final이 아닌 필드에 캐싱하는 방법을 쓸 수도 있다.
