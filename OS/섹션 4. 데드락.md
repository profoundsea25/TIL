> [그림으로 쉽게 배우는 운영체제](https://www.inflearn.com/course/%EB%B9%84%EC%A0%84%EA%B3%B5%EC%9E%90-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/dashboard) 요약입니다.

## 섹션 4. 데드락
### 교착상태(데드락)
- 교착상태 : 여러 프로세스가 서로 다른 프로세스의 작업이 끝나기를 기다리다가 아무도 작업을 진행하지 못하는 상태
- 교착상태의 원인 : 공유자원
- `식사하는 철학자` 상황
- 교착상태의 필요조건 (모두 만족해야 교착상태 발생)
  1. 상호배제 : 어떤 프로세스가 한 리소스를 점유했다면 그 리소스는 다른 프로세스에게 공유가 되면 안 됨 (`포크`)
  2. 비선점 : 어떤 프로세스가 한 리소스를 점유했다면 그 리소스는 다른 프로세스가 빼앗을 수 없음
  3. 점유와 대기 : 프로세스가 한 리소스를 가지고 있는 동시에 다른 리소스가 필요해야 함
  4. 원형 대기 : 점유와 대기를 하는 프로세스들의 관계가 원형을 이룸

### 교착상태 해결
#### 교착상태 회피(Deadlock Avoidance)
- 프로세스들에게 자원을 할당할 때 어느 정도 자원을 할당해야 교착상태가 발생하는지 파악해서 교착상태가 발생하지 않는 수준의 자원을 할당
- 전체 자원과 할당된 자원을 기준으로 안정상태와 불안정상태로 나눔
- 운영체제는 최대한 안정상태를 유지하려고 함
- `은행원 알고리즘`
  - 운영체제는 프로세스들에게 자원을 할당하기 전에 자기가 가지고 있는 전체 자원의 수(시스템의 총 자원)를 알고 있어야 함
  - 프로세스들은 각자 자기가 필요한 자원의 최대숫자(최대 요구 자원)를 운영체제에게 알려줘야 함
  - 운영체제는 각 프로세스가 현재 요구할 수 있는 요청이 예상되는 자원을 계산함
  - 불안정상태에 빠지지 않도록 유지하는 것이 좋음
  - 교착상태를 피하는 좋은 방법이지만 비용이 비싸고 비효율적
- 이를 극복하기 위해 교착상태를 회피하는 것보다, 교착상태 발생을 허용하고 그것을 해결하는 쪽을 연구
#### 교착상태 검출
1. 가벼운 교착 상태 검출
  - 프로세스가 일정시간 동안 작업을 진행하지 않는다면 교착상태가 발생했다고 간주하고 교착상태 해결
  - 일정 시점마다 체크포인트를 만들어 작업을 저장하고 타임아웃으로 교착상태 발생시 마지막으로 저장했던 체크포인트로 롤백
2. 무거운 교착 상태 검출
  - 자원 할당 그래프 이용
  - 현재 운영체제에서 프로세스가 어떤 자원을 사용하는지 지켜보고 교착상태가 발생했다면 해결
  - 프로세스 간 그래프를 만들고, 순환구조가 발견된다면 교착상태로 간주하고 프로세스를 강제 종료. 그리고 다시 실행시킬 때 체크포인트로 롤백
  - 운영체제가 지속적으로 자원 할당 그래프를 유지하고 검사해야 하기 때문에 오버헤드 발생
  - 하지만 가벼운 교착상태 검출에서 발생할 수 있는 억울하게 종료되는 프로세스는 발생하지 않음
