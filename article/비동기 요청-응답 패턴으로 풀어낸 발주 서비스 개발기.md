# [비동기 요청-응답 패턴으로 풀어낸 발주 서비스 개발기](https://oliveyoung.tech/2025-06-30/purchase-order-service/)

![최종 구조](https://oliveyoung.tech/static/4a260740b2edb5291201332fe186c1e3/3004a/third-archi.png)
- 동기식 처리를 비동기식으로 바꿈
    - 사용자 -> 요청 이벤트 발행 -> 요청 Kafka -> 요청 처리 Consumer + 응답 이벤트 발행 -> 응답 Kafka -> 응답 처리 Consumer -> 사용자
- 글로 보아서는 사용자 입장에서는 똑같은 동기 처리로 보임. 내부는 메시지큐 기반의 비동기 처리 방식을 선택.
    - 기존 방식은 엑셀 파일을 업로드하면, 엑셀 파일의 모든 row를 하나의 노드에서 처리함.
    - 이러한 비효율적 방식을 개선하기 위해, row마다 메시지를 발행하여, 여러 노드(컨슈머)에서 처리할 수 있도록 함.
    - 확장과 노드 스케일 아웃하기 쉬워짐.
- 여러 노드에서 처리하면서도 중복 처리 방지에 주의를 기울임.
    - 요청에 대해 식별자를 부여. 요청이 어디로부터 유입되었는지도 기록.
- 처리 중 발생하는 오류는 DLQ 사용. 모니터링 툴에 알림을 발생시키도록 한다.

---

### Comment
- 구조가 복잡해지지 않으려면 폴링도 나쁘지 않을지도
    - 실시간성이 정말 중요하다면 당연히 응답 메시지 처리를 스트림으로