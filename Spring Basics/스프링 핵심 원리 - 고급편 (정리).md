> 김영한님의 [스프링 핵심 원리 - 고급편](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B3%A0%EA%B8%89%ED%8E%B8) 강의 내용 정리입니다.

# 2. 쓰레드 로컬
### 동시성 문제
- 쓰레드가 동시에 같은 인스턴스의 필드 값을 변경하면서 발생하는 문제
- 여러 쓰레드가 같은 인스턴스의 필드에 접근해야 하지 때문에 트래픽이 적은 상황에서는 확률상 잘 나타나지 않고, 트래픽이 점점 많아질수록 자주 발생
- 특히 스프링 빈처럼 싱글톤 객체의 필드를 변경하며 사용할 때 이러한 동시성 문제를 조심해야 함.
- 동시성 문제는 지역 변수에서는 발생하지 않음. 지역 변수는 쓰레드마다 각각 다른 메모리 영역이 할당됨.
- 동시성 문제가 발생하는 곳은 인스턴스의 필드(주로 싱글톤에서 자주 발생), 또는 static 같은 공용 필드에 접근할 때 발생
- 동시성 문제는 값을 읽기만 하면 발생하지 않음. 어디선가 값을 변경하기 때문에 발생
- 동시성 문제를 해결하기 위해 사용하는 것이 바로 쓰레드 로컬

### ThreadLocal
- 쓰레드 로컬이란 해당 쓰레드만 접근할 수 있는 특별한 저장소
- 해당 쓰레드가 쓰레드 로컬을 모두 사용하고 나면 `ThreadLocal.remove()`를 호출해서 쓰레드 로컬에 저장된 값을 제거해주어야 한다.
- 값을 저장할 때는 `.set()`, 값을 조회할 때는 `.get()`
- 쓰레드 로컬의 값을 사용 후 제거하지 않고 그냥 두면 WAS(톰캣)처럼 쓰레드 풀을 사용하는 경우에 심각한 문제가 발생할 수 있다.

# 3. 템플릿 메서드 패턴과 콜백 패턴
